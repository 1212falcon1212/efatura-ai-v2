databaseChangeLog:
  - changeSet:
      id: 004-api-keys
      author: efaturaai
      changes:
        - createTable:
            tableName: api_keys
            columns:
              - column: { name: id, type: UUID, constraints: { primaryKey: true, nullable: false } }
              - column: { name: tenant_id, type: UUID, constraints: { nullable: false } }
              - column: { name: name, type: "VARCHAR(120)", constraints: { nullable: false } }
              - column: { name: api_key, type: "VARCHAR(128)", constraints: { nullable: false, unique: true } }
              - column: { name: scopes, type: JSONB }
              - column: { name: active, type: BOOLEAN, defaultValueBoolean: true, constraints: { nullable: false } }
              - column: { name: created_at, type: "TIMESTAMP WITH TIME ZONE", defaultValueComputed: CURRENT_TIMESTAMP, constraints: { nullable: false } }
        - addForeignKeyConstraint:
            baseTableName: api_keys
            baseColumnNames: tenant_id
            constraintName: fk_api_keys_tenant
            referencedTableName: tenants
            referencedColumnNames: id
            onDelete: CASCADE

